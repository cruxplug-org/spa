{"version":3,"sources":["../src/utils/seo.ts","../src/utils/spa.ts","../src/utils/errors.ts","../src/index.ts"],"names":["generateSEOMetaTags","config","baseConfig","canonicalUrl","robots","description","keywords","script","generateStructuredData","pageConfig","contentType","schema","generateSPAHTML","clientScripts","clientStyles","scriptTags","styleTags","style","createSPARoute","c","html","buildErrorResponse","statusCode","errorPageMap","path","errorConfig","createErrorHandler","errorResponse","createDefault404Page","serverSPA","routes","errorPageConfig","defaultErrorPage","errorHandler","app","statusCodes","ctx"],"mappings":"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","file":"index.js","sourcesContent":["// src/utils/seo.ts\r\n//\r\n// Made with â¤ï¸ by Maysara.\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    import type { SPAPageConfig, ServerSPAPluginConfig } from '../types';\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UTIL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    /**\r\n     * Generate SEO Meta Tags with E-E-A-T signals\r\n     *\r\n     * Includes:\r\n     * - Core SEO metadata (charset, viewport, description, keywords, robots)\r\n     * - E-E-A-T signals (expertise, experience, authority)\r\n     * - Mobile optimization (web app capable, status bar style)\r\n     * - Performance & security (prefetch, x-ua-compatible)\r\n     * - Open Graph protocol tags\r\n     */\r\n    export function generateSEOMetaTags(\r\n        config: SPAPageConfig,\r\n        baseConfig: ServerSPAPluginConfig\r\n    ): string {\r\n        const canonicalUrl = config.canonical || `${baseConfig.baseUrl}${config.path}`;\r\n        const robots = config.robots || baseConfig.defaultRobots || 'index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1';\r\n        const description = config.description || baseConfig.defaultDescription || 'A modern single-page application';\r\n        const keywords = (config.keywords || baseConfig.defaultKeywords || []).join(', ');\r\n\r\n        return `\r\n        <!-- ğŸ” Core SEO Meta Tags -->\r\n        <meta charset=\"UTF-8\" />\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\r\n        <meta name=\"description\" content=\"${description}\" />\r\n        ${keywords ? `<meta name=\"keywords\" content=\"${keywords}\" />` : ''}\r\n        <meta name=\"robots\" content=\"${robots}\" />\r\n        <meta name=\"language\" content=\"en\" />\r\n        <meta http-equiv=\"content-language\" content=\"en-us\" />\r\n\r\n        <!-- ğŸ‘¥ E-E-A-T Signals for AI Search -->\r\n        ${baseConfig.author ? `<meta name=\"author\" content=\"${baseConfig.author}\" />` : ''}\r\n        ${config.expertise ? `<meta name=\"expertise\" content=\"${config.expertise}\" />` : ''}\r\n        ${config.experience ? `<meta name=\"experience\" content=\"${config.experience}\" />` : ''}\r\n        ${config.authority ? `<meta name=\"authority\" content=\"${config.authority}\" />` : ''}\r\n\r\n        <!-- ğŸ“± Mobile & Performance -->\r\n        <meta name=\"mobile-web-app-capable\" content=\"yes\" />\r\n        <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\r\n        <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\" />\r\n        <meta name=\"theme-color\" content=\"#000000\" />\r\n\r\n        <!-- ğŸ”— Canonical & Prefetch -->\r\n        <link rel=\"canonical\" href=\"${canonicalUrl}\" />\r\n        ${(config.clientScriptPath || baseConfig.clientScriptPath)?.map(script => `<link rel=\"prefetch\" href=\"${script}\" />`).join('\\n        ')}\r\n\r\n        <!-- âš¡ Performance & Security -->\r\n        <meta name=\"format-detection\" content=\"telephone=no\" />\r\n        <meta http-equiv=\"x-ua-compatible\" content=\"IE=edge\" />\r\n        ${config.ogImage ? `<meta property=\"og:image\" content=\"${config.ogImage}\" />` : ''}\r\n        <meta property=\"og:title\" content=\"${config.title}\" />\r\n        <meta property=\"og:description\" content=\"${description}\" />\r\n        <meta property=\"og:url\" content=\"${canonicalUrl}\" />`;\r\n    }\r\n\r\n    /**\r\n     * Generate JSON-LD Structured Data\r\n     *\r\n     * Creates schema.org compatible structured data for:\r\n     * - Rich snippets in search results\r\n     * - AI overviews and knowledge panels\r\n     * - Better indexing and SEO\r\n     *\r\n     * Supports multiple content types: WebPage, Article, Product, Service, etc.\r\n     */\r\n    export function generateStructuredData(\r\n        pageConfig: SPAPageConfig,\r\n        baseConfig: ServerSPAPluginConfig,\r\n        contentType: string = 'WebPage'\r\n    ): string {\r\n        const canonicalUrl = pageConfig.canonical || `${baseConfig.baseUrl}${pageConfig.path}`;\r\n\r\n        const schema = {\r\n            '@context': 'https://schema.org',\r\n            '@type': contentType,\r\n            'name': pageConfig.title,\r\n            'url': canonicalUrl,\r\n            'description': pageConfig.description || baseConfig.defaultDescription,\r\n            'inLanguage': 'en',\r\n            ...(pageConfig.contentType && { 'genre': pageConfig.contentType }),\r\n            ...(baseConfig.author && {\r\n                'author': {\r\n                    '@type': 'Person',\r\n                    'name': baseConfig.author,\r\n                    ...(baseConfig.authorUrl && { 'url': baseConfig.authorUrl })\r\n                }\r\n            }),\r\n            ...(pageConfig.expertise || pageConfig.experience || pageConfig.authority) && {\r\n                'creator': {\r\n                    '@type': 'Person',\r\n                    'name': baseConfig.author || 'Unknown',\r\n                    ...(pageConfig.expertise && { 'expertise': pageConfig.expertise }),\r\n                    ...(pageConfig.experience && { 'experience': pageConfig.experience }),\r\n                    ...(pageConfig.authority && { 'authority': pageConfig.authority })\r\n                }\r\n            }\r\n        };\r\n\r\n        return `<script type=\"application/ld+json\">${JSON.stringify(schema, null, 2)}</script>`;\r\n    }\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n","// src/utils/spa.ts\r\n//\r\n// Made with â¤ï¸ by Maysara.\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    import type { RouteDefinition, AppContext } from '@cruxjs/base';\r\n    import type { SPAPageConfig, ServerSPAPluginConfig } from '../types';\r\n    import { generateSEOMetaTags, generateStructuredData } from './seo';\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UTIL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    /**\r\n     * Generate SPA HTML shell with SEO metadata\r\n     *\r\n     * Creates a complete HTML document with:\r\n     * - SEO meta tags\r\n     * - Structured data (JSON-LD)\r\n     * - App mount point (#app)\r\n     * - Client-side JavaScript and style entry points\r\n     */\r\n    export function generateSPAHTML(\r\n        pageConfig: SPAPageConfig,\r\n        baseConfig: ServerSPAPluginConfig\r\n    ): string {\r\n        const clientScripts = pageConfig.clientScriptPath || baseConfig.clientScriptPath;\r\n        const clientStyles = pageConfig.clientStylePath || baseConfig.clientStylePath || [];\r\n\r\n        const scriptTags = clientScripts\r\n            .map(script => `    <script type=\"module\" src=\"${script}\"></script>`)\r\n            .join('\\n');\r\n\r\n        const styleTags = clientStyles\r\n            .map(style => `    <link rel=\"stylesheet\" href=\"${style}\" />`)\r\n            .join('\\n');\r\n\r\n        return `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    ${generateSEOMetaTags(pageConfig, baseConfig)}\r\n    ${generateStructuredData(pageConfig, baseConfig, pageConfig.contentType === 'article' ? 'Article' : 'WebPage')}\r\n    ${styleTags ? styleTags : ''}\r\n</head>\r\n<body>\r\n    <div id=\"app\"></div>\r\n${scriptTags}\r\n</body>\r\n</html>`;\r\n    }\r\n\r\n    /**\r\n     * Create SPA route definition for a page\r\n     *\r\n     * Generates a RouteDefinition that handles GET requests\r\n     * and returns the full SPA HTML shell with SEO data\r\n     */\r\n    export function createSPARoute(\r\n        pageConfig: SPAPageConfig,\r\n        baseConfig: ServerSPAPluginConfig\r\n    ): RouteDefinition {\r\n        return {\r\n            method: 'GET',\r\n            path: pageConfig.path,\r\n            handler: (c: AppContext) => {\r\n                const html = generateSPAHTML(pageConfig, baseConfig);\r\n                return c.html(html);\r\n            }\r\n        };\r\n    }\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n","// src/utils/errors.ts\r\n//\r\n// Made with â¤ï¸ by Maysara.\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    import type { ErrorPageConfig, ServerSPAPluginConfig } from '../types';\r\n    import { generateSPAHTML } from './spa';\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TYPE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    /**\r\n     * Error response definition\r\n     */\r\n    interface ErrorResponse {\r\n        status: number;\r\n        headers: Record<string, string>;\r\n        body: string;\r\n    }\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UTIL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    /**\r\n     * Build error response with appropriate content type\r\n     * \r\n     * Returns HTML for web requests and JSON for API requests\r\n     */\r\n    export function buildErrorResponse(\r\n        statusCode: number,\r\n        errorPageMap: Map<number, ErrorPageConfig>,\r\n        baseConfig: ServerSPAPluginConfig,\r\n        path: string\r\n    ): ErrorResponse {\r\n        // API requests get JSON responses\r\n        if (path.startsWith('/api/')) {\r\n            return {\r\n                status: statusCode,\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ error: `Error ${statusCode}` })\r\n            };\r\n        }\r\n\r\n        // Try to find custom error page\r\n        if (errorPageMap.has(statusCode)) {\r\n            const errorConfig = errorPageMap.get(statusCode)!;\r\n            const html = generateSPAHTML(errorConfig, baseConfig);\r\n            return {\r\n                status: statusCode,\r\n                headers: { 'Content-Type': 'text/html; charset=utf-8' },\r\n                body: html\r\n            };\r\n        }\r\n\r\n        // Fallback: plain text error\r\n        return {\r\n            status: statusCode,\r\n            headers: { 'Content-Type': 'text/plain' },\r\n            body: `Error ${statusCode}`\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create error handler function for CruxJS\r\n     * \r\n     * Handles:\r\n     * - 404 Not Found pages (with auto-generation support)\r\n     * - Custom error pages by status code\r\n     * - API vs web request differentiation\r\n     * - Fallback error responses\r\n     */\r\n    export function createErrorHandler(\r\n        errorPageMap: Map<number, ErrorPageConfig>,\r\n        baseConfig: ServerSPAPluginConfig\r\n    ): (statusCode: number, path: string) => Response {\r\n        return (statusCode: number, path: string) => {\r\n            const errorResponse = buildErrorResponse(statusCode, errorPageMap, baseConfig, path);\r\n            return new Response(errorResponse.body, {\r\n                status: errorResponse.status,\r\n                headers: errorResponse.headers\r\n            });\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create default 404 error page config\r\n     */\r\n    export function createDefault404Page(): ErrorPageConfig {\r\n        return {\r\n            statusCode: 404,\r\n            title: '404 - Page Not Found',\r\n            path: '/404',\r\n            description: 'The page you are looking for could not be found.',\r\n            keywords: ['404', 'not found', 'error'],\r\n            robots: 'noindex, nofollow'\r\n        };\r\n    }\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n","/* eslint-disable @typescript-eslint/no-unused-vars */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// src/index.ts\r\n//\r\n// Made with â¤ï¸ by Maysara.\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PACK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    import type {\r\n        CruxPlugin,\r\n        AppInstance\r\n    } from '@cruxjs/base';\r\n\r\n    import * as types from './types';\r\n    import { createSPARoute } from './utils/spa';\r\n    import { createErrorHandler, createDefault404Page } from './utils/errors';\r\n\r\n    export * from './types';\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n\r\n\r\n\r\n// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CORE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n\r\n    /**\r\n     * Create Server SPA Plugin\r\n     *\r\n     * Generates SPA routes with SEO/CEO metadata and structured data\r\n     * Error pages are handled via CruxJS error hooks\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const spaPlugin = serverSPA({\r\n     *   baseUrl: 'https://example.com',\r\n     *   clientEntry: './src/client/browser.tsx',\r\n     *   clientScriptPath: '/static/dist/js/min.js',\r\n     *   clientStylePath: '/static/dist/css/min.css',\r\n     *   enableAutoNotFound: true,  // Auto-handle 404s\r\n     *   pages: [\r\n     *     {\r\n     *       title: 'Home',\r\n     *       path: '/',\r\n     *       description: 'Welcome to our platform'\r\n     *     }\r\n     *   ],\r\n     *   errorPages: [\r\n     *     {\r\n     *       statusCode: 404,\r\n     *       title: '404 - Not Found',\r\n     *       path: '/404',\r\n     *       description: 'Page not found'\r\n     *     }\r\n     *   ]\r\n     * });\r\n     * ```\r\n     */\r\n    export function serverSPA(config: types.ServerSPAPluginConfig): CruxPlugin & { __spaErrorHandler?: any } {\r\n        const routes = [];\r\n        const errorPageMap = new Map<number, types.ErrorPageConfig>();\r\n\r\n        // Generate routes from config\r\n        if (config.pages && config.pages.length > 0) {\r\n            for (const pageConfig of config.pages) {\r\n                routes.push(createSPARoute(pageConfig, config));\r\n            }\r\n        }\r\n\r\n        // Setup error pages\r\n        if (config.errorPages && config.errorPages.length > 0) {\r\n            for (const errorPageConfig of config.errorPages) {\r\n                errorPageMap.set(errorPageConfig.statusCode, errorPageConfig);\r\n                // Register error page as a regular route too (for direct access like /404)\r\n                routes.push(createSPARoute(errorPageConfig, config));\r\n            }\r\n        }\r\n\r\n        // Auto-generate 404 page if enabled and not already defined\r\n        if (config.enableAutoNotFound && !errorPageMap.has(404)) {\r\n            const defaultErrorPage = createDefault404Page();\r\n            errorPageMap.set(404, defaultErrorPage);\r\n            // Also register as a regular route\r\n            routes.push(createSPARoute(defaultErrorPage, config));\r\n        }\r\n\r\n        // Create error handler function\r\n        const errorHandler = createErrorHandler(errorPageMap, config);\r\n\r\n        const plugin: CruxPlugin & { __spaErrorHandler?: any } = {\r\n            name: '@cruxplug/SPA',\r\n            version: '0.1.0',\r\n\r\n            routes,\r\n\r\n            // Attach error handler for CruxJS to use\r\n            __spaErrorHandler: errorHandler,\r\n\r\n            onRegister: async (app: AppInstance) => {\r\n                console.log(`[SPA Plugin] Registered ${routes.length} SPA routes`);\r\n                if (errorPageMap.size > 0) {\r\n                    const statusCodes = Array.from(errorPageMap.keys()).join(', ');\r\n                    console.log(`[SPA Plugin] Error pages configured for: ${statusCodes}`);\r\n                }\r\n            },\r\n\r\n            onAwake: async (ctx: any) => {\r\n                console.log('[SPA Plugin] Awake phase - SPA routes ready');\r\n            },\r\n\r\n            onStart: async (ctx: any) => {\r\n                console.log('[SPA Plugin] Start phase - serving SPA');\r\n            },\r\n\r\n            onReady: async (ctx: any) => {\r\n                console.log('[SPA Plugin] Ready phase - SPA is fully operational');\r\n            }\r\n        };\r\n\r\n        return plugin;\r\n    }\r\n\r\n// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"]}